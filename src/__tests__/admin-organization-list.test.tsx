import { screen, render, waitFor, fireEvent } from "@testing-library/react";
import { SnackbarProvider } from "notistack";
import { MockedProvider } from "@apollo/client/testing";

jest.mock("next/router", () => ({
  __esModule: true,
  useRouter: jest.fn(),
}));

import { GET_ADMIN_TOKEN_DATA } from "../graphql/query/common";
import { useAppContext } from "../contexts/AuthContext";
import Organization from "../pages/admin/organization/list/index";
import { GET_TEMPLATE_LIST } from "../graphql/query/resource";
import { GET_ORGANIZATION_LIST } from "../graphql/query/organization";
import { DELETE_ORG_BY_ID } from "../graphql/mutation/patient";

jest.mock("../contexts/AuthContext");

// mocks
const mocksData = [];

mocksData.push({
  request: {
    query: GET_ADMIN_TOKEN_DATA,
    variables: {},
  },
  result: {
    data: {
      getTokenData: {
        _id: "some-admin-id",
        user_type: "admin",
        parent_id: "73ddc746-b473-428c-a719-9f6d39bdef81",
        perm_ids: "9,10,14,21,191,65,66",
        user_status: "1",
        created_date: "2021-12-20 16:20:55",
        updated_date: "2021-12-20 16:20:55",
      },
    },
  },
});

mocksData.push(
  {
    request: {
      query: GET_ORGANIZATION_LIST,
    },
    result: {
      data: {
        getOrganizationData: [
          {
            _id: "517fa21a82c0464a92aaae90ae0d5c59",
            contract:
              '<p class="MsoNormal" align="center" style="margin-bottom: 0cm; text-align: center; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><b>SUMMARY OF THE AGREEMENT </b></p><p class="MsoNormal" align="center" style="margin-bottom: 0cm; text-align: center; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><br></p><p class="MsoNormal" style="text-align: justify; margin-bottom: 0cm; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-family: monteserrat, serif;">This\r\nAgreement is a legally binding contract between You and the <span style="background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">Therapist</span> for <span style="background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">Therapy</span>. \r\nA summary of the main matters dealt within this agreement are listed below:</span></p><p class="MsoNormal" style="text-align: justify; margin-bottom: 0cm; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-family: monteserrat, serif;"><br></span></p><p class="MsoNormal" style="text-align: justify; margin-bottom: 0cm; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 10.5pt; font-family: monteserrat, serif;"><o:p></o:p></span></p><ul style="margin-top:0cm" type="disc">\r\n <li style="margin-bottom: 0cm; line-height: normal; vertical-align: baseline;"><i><span style="font-family:" monteserrat",serif;mso-fareast-font-family:"times="" new="" roman";="" mso-bidi-font-family:calibri;mso-fareast-language:en-in"="">What the\r\n     Therapist will do for You;</span></i><i><o:p></o:p></i></li><li style="margin-bottom: 0cm; line-height: normal; vertical-align: baseline;"><i><span style="font-family:" monteserrat",serif;mso-fareast-font-family:"times="" new="" roman";="" mso-bidi-font-family:calibri;mso-fareast-language:en-in"="">What is expected\r\n     from You;</span></i><i><o:p></o:p></i></li><li style="margin-bottom: 0cm; text-align: justify; line-height: normal; vertical-align: baseline;"><i><span style="font-family:" monteserrat",serif;="" mso-fareast-font-family:"times="" new="" roman";mso-bidi-font-family:calibri;="" mso-fareast-language:en-in"="">Confidentiality and Data Protection;</span></i><i><o:p></o:p></i></li><li style="margin-bottom: 0cm; text-align: justify; line-height: normal; vertical-align: baseline;"><i><span style="font-family:" monteserrat",serif;="" mso-fareast-font-family:"times="" new="" roman";mso-bidi-font-family:calibri;="" mso-fareast-language:en-in"="">Ending this Agreement; and</span></i><i><o:p></o:p></i></li><li style="margin-bottom: 0cm; text-align: justify; line-height: normal; vertical-align: baseline;"><i><span style="font-family:" monteserrat",serif;="" mso-fareast-font-family:"times="" new="" roman";mso-bidi-font-family:calibri;="" mso-fareast-language:en-in"="">General terms (ie feedback and concern</span></i></li></ul><p style="margin-bottom: 0cm; text-align: justify; line-height: normal; vertical-align: baseline;"><i><span style="font-family:" monteserrat",serif;="" mso-fareast-font-family:"times="" new="" roman";mso-bidi-font-family:calibri;="" mso-fareast-language:en-in"=""><br></span></i></p><p class="MsoNormal" align="center" style="margin-bottom: 0cm; text-align: center; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><br></p><p class="MsoNormal" align="center" style="margin-bottom: 0cm; text-align: center; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><b>IMPORTANT – PLEASE READ CAREFULLY</b></p><p class="MsoNormal" align="center" style="margin-bottom: 0cm; text-align: center; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><b><br></b></p><p class="MsoNormal" style="margin-bottom: 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-family: monteserrat, serif;">Therapy is a collaborative endeavour\r\nrequiring both the Therapist and You to work together to achieve mutually\r\nagreed goals. To achieve these goals both the Therapist and You need to make a\r\ngood-faith effort to engage in the Therapy process together. It is important\r\nthat You talk with your Therapist if You have any concerns about the process,\r\nthe direction of therapy or have any concerns about your well-being and\r\nsafety.  </span></p><p class="MsoNormal" style="margin-bottom: 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-family: monteserrat, serif;"><o:p><br></o:p></span></p><p class="MsoNormal" style="margin-bottom: 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-family: monteserrat, serif;"><o:p><br></o:p></span></p><p class="MsoNormal" align="center" style="margin-bottom: 0cm; text-align: center; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><br></p><p class="MsoNormal" align="center" style="margin-bottom: 0cm; text-align: center; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><br></p><p class="MsoNormal" align="center" style="margin-bottom: 0cm; text-align: center; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><b>TERMS AND CONDITIONS</b></p><p class="MsoNormal" align="center" style="margin-bottom: 0cm; text-align: center; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><b><br></b></p><p class="MsoNormal" align="center" style="margin-bottom: 0cm; text-align: center; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"></p><div style="text-align: left;"><b>1. Definitions</b></div><p></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-family: monteserrat, serif;">1.1 The\r\nfollowing definitions shall apply in this agreement:</span></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><font face="monteserrat, serif"><b>MyHelp:</b> MyHelp Limited company registered in the United Kingdom with registration number 12495501</font></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><font face="monteserrat, serif"><br></font><span style="font-family: monteserrat, serif;"><b>BABCP:</b> British Association for Behavioural and Cognitive Psychotherapists</span></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-family: monteserrat, serif;"><br></span><span style="font-family: monteserrat, serif;"><b>BACP:</b> British Association for Therapy and Psychotherapy</span></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-family: monteserrat, serif;"><b>BPS:</b> British Psychological Society</span><br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-family: monteserrat, serif;"><b>Therapy Services:</b> the provision of Therapy services to meet your requirements by the Therapist to You.</span><br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-family: monteserrat, serif;"><b>Therapy Sessions:</b> the agreed number of Therapy sessions to be provided by the Therapist to You.</span><br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-family: monteserrat, serif;"><b>Fee:</b> the agreed charge for Therapy Services if applicable.</span><br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-family: monteserrat, serif;"><b>UKCP:</b> UK Council for Psychotherapy.</span></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><b>2. What the Therapist will do</b>  </p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">2.1   The Therapist will use reasonable endeavours to:</p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">a. Provide You with the Therapy Services;<br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">a. ensure that he or she is suitably qualified and is able to provide the Therapy Services in accordance within the procedures and regulations directed by BABCP, BACP, BPS, UKCP or such similar professional body from time to time;</p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">b. offer a quiet, appropriate and undisturbed space for the Therapy Services where the Therapy Sessions are delivered in person;</p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">c. ensure that he or she is available at the agreed times and location where meeting in person;<br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">d. provide the agreed number of Therapy Sessions;<br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">e. maintain safe professional boundaries;<br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">f. comply with necessary safeguarding policies and procedures and work within the  ethical frameworks and Professional Codes of Conduct for the BABCP, BACP, BPS, UKCP and/or any other professional organisation to which the Therapist is associated with.</p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><b>3. What the Therapist expects from you</b><br></p><div style="text-align: justify;"><div><br></div><div>3.1 You shall:</div><div><br></div><div>a. pay to the Therapist the agreed Fee for the Therapy Services;<br></div><div><br></div><div>b. attend punctually all Therapy Sessions agreed with the Therapist;</div><div><br></div><div>c. give the Therapist a minimum of 24 hours’ notice when cancelling or rearranging a Therapy Session;</div><div><br></div><div>d. comply with any confidentiality provisions;</div><div><br></div><div>e. and be respectful to the Therapist and his/her property; and</div><div><br></div><div>f. use reasonable endeavour to complete the agreed number of Therapy Sessions.</div></div><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">3.2 Where You cancel a session without giving the notice required under clause 3.1(c) the Therapist reserves the right to charge the Fee in full for that session. Where You are late for any session the Therapist will provide the Therapy Session for the remainder of the time allocated for original your Therapy Session and You will be charged the Fee in full for that Therapy Session.</p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><b>4. Confidentiality and data protection</b></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">4.1  Subject to clause 4.2 and 4.4 each party undertakes that it shall not at any time disclose to any person any confidential information concerning the Therapy Services, this agreement, or any information relating to either party unless required to do so by law.<br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">4.2  You acknowledge and understand that the Therapist has a duty to disclose confidential information where the Therapist believes You may cause serious physical or emotional harm to yourself or others or have harm caused to You in order to comply with legal, professional, and ethical codes of practice. Wherever possible the Therapist will discuss the breaking of confidentiality with You prior to disclosing information to any other person.<br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">4.3   Where You disclose to the Therapist acts of terrorism, vulnerable adult or child protection issues or drug trafficking issues You acknowledge and understand that the Therapist has a duty to disclose this information to the relevant authorities without delay.</p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">4.4   The Therapist will make notes during and after each session to aid the therapeutic process. Notes will be included on the MyHelp platform and stored securely in accordance with data protection legislation in place from time to time.<br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">4.5   Where you consent the Therapist may take audio or video recordings of the Therapy Sessions. These will be uploaded to the MyHelp platform to assist with the Therapy Services and will be stored in accordance with data protection legislation in place from time to time. You will be consulted and will have the option to decline prior to any audio or video recording being made. <br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">4.6 Data protection legislation restricts the sharing of information gained in Therapy. You consent to the Therapist sharing information with MyHelp for monitoring and feedback purposes and the Therapist confirms that it has entered or will enter into a written agreement with MyHelp incorporating this term. The Therapist shall remain fully liable to You for all acts and omissions of MyHelp relating to information shared under this clause 4.5.<br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">4.7 The Therapist shall comply with all applicable requirements of data protection legislation and associated codes of practice in force from time to time when processing personal data relating to You.<br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><b>5. Supervision</b></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">5.1 The Therapist is required to carry out continuing professional development and engage in regular on-going clinical supervision. You consent to the Therapist sharing anonymised information with their supervisor. This is to help ensure that the Therapy Services You receive are ethical and professional.<br></p><div style="text-align: justify;"><br></div><div style="text-align: justify;"><br></div><div style="text-align: justify;"><div><b>6.Limitation of Liability: Your Attention is drawn to this clause</b></div><div><br></div><div>6.1    The Therapist shall maintain appropriate insurance for the duration of this agreement with a reputable insurer to insure any risks associated with the Therapist carrying out the Therapy Services.</div><div><br></div></div><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><b>7. Ending this Agreement</b><br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">7.1  You can end this agreement immediately at any time by giving notice in writing to the Therapist, however You are encouraged to discuss the ending of the Therapy Services with the Therapist within a session in order that an end date can be agreed.<br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">7.2  The Therapist may end this agreement with immediate effect and with no liability to provide further sessions if at any time You:<br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">a) commit any serious or repeated breach or    </p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">b) non-observance of any of the provisions of this agreement;</p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">c) miss two or more consecutive sessions without contacting the Therapist to cancel or rearrange the sessions;<br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">d) cause the Therapist, in his reasonable opinion, to believe You to be under the influence of alcohol or non-prescribed substances or medication during any of the sessions;<br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">e) fail to pay for the sessions in accordance with the terms agreed;<br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">f) intentionally deceive or set out to manipulate the Therapy and thereby misusing the purpose of the relationship; or cause the Therapist to feel threatened or abused by You.<br></p><div style="text-align: justify;"><br></div><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">7.3 Any provision of this agreement relating to confidentiality or data protection shall remain in full force and effect following the termination of this agreement.</p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><b>8. Feedback and Concerns</b></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">8.1  The Therapist will ask You for your feedback at the end of each session or will ask you to complete the feedback form on MyHelp and You are encouraged to communicate any issues you have with the process verbally with the Therapist in the first instance.<br></p><p class="MsoNormal" style="margin: 16pt 0cm 0cm; text-align: justify; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">8.2 The Therapist welcomes You to discuss any difficulties that may arise in relation to the provision of the Therapy Services and shall endeavour to work with You to</p><div style="text-align: left;"></div><ul style="margin-top:0cm" type="disc">\r\n \r\n \r\n \r\n </ul><ul style="margin-top:0cm" type="disc">\r\n</ul><p>                        </p>',
            created_date: "2021-12-30 16:02:22",
            logo: "20211230160221__logos.png",
            logo_url: null,
            name: "portal.dev-myhelp",
            panel_color: "#6ec9db",
            patient: "Patients",
            patient_plural: "patients",
            patient_welcome_email:
              '<p style="margin-top:0cm"><span style="font-size: 10.5pt; font-family: monteserrat, serif;">Welcome to MyHelp<o:p></o:p></span></p>\r\n\r\n<p style="margin-top: 0cm;"><span style="font-size: 10.5pt; font-family: monteserrat, serif;">Your details have been given by [THERAPIST_NAME] to provide you\r\naccess with the MyHelp platform. The platform will support your therapy\r\nallowing you to share information between yourself and your therapist. We have\r\ncreated the MyHelp platform to support both therapist\'s and patients in their\r\npursuit of a smoother therapy process.<o:p></o:p></span></p>\r\n\r\n<p style="margin-top: 0cm;"><span style="font-size: 10.5pt; font-family: monteserrat, serif;">MyHelp empowers therapist\'s throughout the entire process and\r\ndelivers personalised care with the aim to improve patient outcomes.\r\nSimultaneously, patients can access their own platform to access key\r\ninformation to support their progress and communicate more efficiently with\r\ntheir therapist. We believe the MyHelp platform will enhance the therapeutic\r\nrelationship in order to deliver better results. In order to access your\r\nprivate area of the MyHelp platform you will need to:<o:p></o:p></span></p>\r\n\r\n<p style="margin-top: 0cm;"><span style="font-size: 10.5pt; font-family: monteserrat, serif;">Visit the website:<o:p></o:p></span></p>\r\n\r\n<p style="margin-top: 0cm;"><span style="font-size: 10.5pt; font-family: monteserrat, serif;">Enter the access details: Username – your email address, Password\r\n– Happ1ness<o:p></o:p></span></p>\r\n\r\n<p style="margin-top: 0cm;"><span style="font-size: 10.5pt; font-family: monteserrat, serif;">We recommend that you change your password by clicking the icon in\r\nthe right hand corner to something personal and more memorable.<o:p></o:p></span></p>\r\n\r\n<p style="margin-top: 0cm;"><span style="font-size: 10.5pt; font-family: monteserrat, serif;">Now you have access to your personal therapy guide, which will be\r\ndeveloped with the support of your therapist over the period of your therapy\r\nThis will allow you to access the information and resources now and in the\r\nfuture.<o:p></o:p></span></p>\r\n\r\n<p style="margin-top: 0cm;"><span style="font-size: 10.5pt; font-family: monteserrat, serif;">If you have any other questions then please email\r\ninfo@myhelp.co.uk and we will endeavor to get back to you within 24 hours.<o:p></o:p></span></p>\r\n\r\n<p style="margin-top: 0cm;"><span style="font-size: 10.5pt; font-family: monteserrat, serif;">Thank you,<o:p></o:p></span></p>\r\n\r\n<p style="margin-top: 0cm;"><span style="font-size: 10.5pt; font-family: monteserrat, serif;">MyHelp Team.<o:p></o:p></span></p>\r\n\r\n<p style="margin-top: 0cm;"><span style="font-size: 10.5pt; font-family: monteserrat, serif;">P.S. Need help getting started? Please have a look at our help\r\ndocumentation or just reply to this email with any questions or issues you may\r\nhave. The MyHelp support team is available to help with the platform only.\r\nUnfortunately, we do not provide mental health services and cannot support you\r\nin this respect. Please contact your therapist in such cases.<o:p></o:p></span></p>',
            side_menu_color: "#6ec9db",
            therapist: "Therapist",
            therapy: "Therapy",
            __typename: "Organization",
          },
        ],
      },
    },
  },
  {
    request: {
      query: GET_TEMPLATE_LIST,
      variables: {},
    },
    result: {
      data: null,
    },
  }
);

mocksData.push({
  request: {
    query: DELETE_ORG_BY_ID,
    variables: { orgId: "517fa21a82c0464a92aaae90ae0d5c59" },
  },
  result: {},
});
const sut = async () => {
  render(
    <MockedProvider mocks={mocksData} addTypename={false}>
      <SnackbarProvider>
        <Organization />
      </SnackbarProvider>
    </MockedProvider>
  );

  screen.queryByTestId("activity-indicator");
};

describe("TemplateList Page", () => {
  beforeEach(() => {
    (useAppContext as jest.Mock).mockReturnValue({
      isAuthenticated: true,
      user: {
        _id: "9ea296b4-4a19-49b6-9699-c1e2bd6fc946",
        user_type: "patient",
        parent_id: "73ddc746-b473-428c-a719-9f6d39bdef81",
        perm_ids: "9,10,14,21,191,65,66",
        user_status: "1",
        created_date: "2021-12-20 16:20:55",
        updated_date: "2021-12-20 16:20:55",
      },
    });
  });

  test("Renders organization tab list screen", async () => {
    await sut();
    await waitFor(() =>
      expect(screen.queryByTestId("tableId")).toBeInTheDocument()
    );
    await waitFor(() =>
      expect(screen.queryAllByTestId("table-row").length).toBe(1)
    );
  });

  it("Delete org with comfirmation.", async () => {
    await sut();
    await waitFor(() =>
      expect(screen.queryByTestId("tableId")).toBeInTheDocument()
    );

    await waitFor(() =>
      expect(screen.queryByTestId("deleteIcon")).toBeInTheDocument()
    );

    await waitFor(async () => {
      fireEvent.click(screen.queryByTestId("deleteIcon"));
    });
    await (async () => {
      expect(screen.queryByTestId("sureModal")).toBeInTheDocument();
    });

    expect(screen.getByTestId("deleteOrgConfirmButton")).toBeVisible();

    fireEvent.click(screen.queryByTestId("deleteOrgConfirmButton"));

    await (async () => {
      expect(screen.queryByTestId("SuccessOkBtn")).toBeInTheDocument();
    });

    await waitFor(async () => {
      expect(
        screen.getByText("Organisation Deleted Successfully")
      ).toBeInTheDocument();
    });

    await waitFor(async () => {
      fireEvent.click(screen.queryByTestId("SuccessOkBtn"));
    });

    await waitFor(() =>
      expect(screen.queryByTestId("tableId")).toBeInTheDocument()
    );
  });

  it("Delete org with cancel button.", async () => {
    await sut();
    await waitFor(() =>
      expect(screen.queryByTestId("tableId")).toBeInTheDocument()
    );

    await waitFor(() =>
      expect(screen.queryByTestId("deleteIcon")).toBeInTheDocument()
    );

    await waitFor(async () => {
      fireEvent.click(screen.queryByTestId("deleteIcon"));
    });
    await (async () => {
      expect(screen.queryByTestId("sureModal")).toBeInTheDocument();
    });

    expect(screen.getByTestId("deleteOrgCancelButton")).toBeVisible();

    fireEvent.click(screen.queryByTestId("deleteOrgCancelButton"));

    await waitFor(() =>
      expect(screen.queryByTestId("tableId")).toBeInTheDocument()
    );
  });
});
